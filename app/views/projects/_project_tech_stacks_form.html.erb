<%= f.label :tech_stacks, "Technologies utilisées", class: "block text-sm font-medium text-gray-700 sm:mt-px sm:pt-2" %>
<div class="mt-1 sm:col-span-2 sm:mt-0">
    <div class="space-y-4 max-h-96 overflow-y-auto p-4 bg-gray-50 rounded-lg">
        <div class="grid grid-cols-1 gap-4">
            <% @tech_stacks.each do |tech_stack| %>
                <div class="flex items-center justify-between p-3 bg-white rounded-lg shadow-sm">
                    <div class="flex items-center space-x-3">
                        <%= check_box_tag "project[tech_stack_attributes][]", 
                            tech_stack.id,
                            @project.tech_stack_ids.include?(tech_stack.id),
                            id: dom_id(tech_stack),
                            class: "h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600"
                        %>
                        <%= label_tag dom_id(tech_stack), tech_stack.name, class: "ml-3 font-medium text-gray-900" %>
                    </div>
                    
                    <div class="flex-shrink-0">
                        <%= select_tag "project[tech_stack_levels][]",
                            options_for_select(
                                ProjectTechStack.levels.keys.map { |level| [level.titleize, level] },
                                @project.project_tech_stacks.find_by(tech_stack: tech_stack)&.level
                            ),
                            class: "block w-32 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
                        %>
                    </div>
                </div>
            <% end %>
        </div>
    </div>
    <%= hidden_field_tag "project[tech_stack_attributes][]", nil %>
    <p class="mt-2 text-sm text-gray-500">Sélectionnez les technologies utilisées et leur niveau de maîtrise dans ce projet.</p>
</div>